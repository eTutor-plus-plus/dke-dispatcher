25;SELECT MIN(TO_DATE(rp.datum)) as Tag\r\nFROM   rechnungpos rp\r\nWHERE  (SELECT SUM(rp2.menge*rp2.einzelpreis)\r\n        FROM   rechnungpos rp2\r\n        WHERE  rp2.datum<=rp.datum) > 0.5 *\r\n       (SELECT SUM(rp3.menge*rp3.einzelpreis)\r\n        FROM   rechnungpos rp3)\r\n;org.postgresql.util.PSQLException: FEHLER: Funktion to_date(date) existiert nicht\n  Hinweis: Keine Funktion stimmt mit dem angegebenen Namen und den Argumenttypen überein. Sie müssen möglicherweise ausdrückliche Typumwandlungen hinzufügen.\n  Position: 12 \n;SELECT MIN(rp.datum) as Tag\nFROM   rechnungpos rp\nWHERE  (SELECT SUM(rp2.menge*rp2.einzelpreis)\n        FROM   rechnungpos rp2\n        WHERE  rp2.datum<=rp.datum) > 0.5 *\n       (SELECT SUM(rp3.menge*rp3.einzelpreis)\n        FROM   rechnungpos rp3)
29;SELECT AVG(COUNT (*)) AS ANZAHL FROM human p, parent par WHERE ParentName = name AND gender = 'f' GROUP BY name;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 12 \n;SELECT \n\tAVG(ANZAHL)\n\tFROM\n\t(\n\t\tSELECT \n\t\t\tCOUNT (*) AS ANZAHL\n\t\tFROM \n\t\t\thuman p, parent par \n\t\tWHERE \n\t\t\tParentName = name AND gender = 'f' \n\t\tGROUP BY name\n\t) as subquery
31;SELECT p.ChildName As Name FROM parent p, parent geschwister WHERE p.ParentName = geschwister.ParentName \r\nGROUP BY p.ChildName HAVING COUNT (distinct geschwister.ChildName) >\r\n(SELECT AVG(COUNT(distinct g.ChildName)) FROM parent p2, parent g WHERE p2.ParentName = g.ParentName \r\nGROUP BY p2.ChildName);org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 190 \n;SELECT \n\tp.ChildName As Name \nFROM \n\tparent p, parent geschwister \nWHERE \n\tp.ParentName = geschwister.ParentName \nGROUP BY \n\tp.ChildName \nHAVING COUNT (distinct geschwister.ChildName) >\n\t(\n\t\tSELECT AVG(count)\n\t\tFROM\n\t\t(\n\t\t\tSELECT \n\t\t\t\tCOUNT(distinct g.ChildName)\n\t\t\tFROM parent p2, parent g \n\t\t\tWHERE p2.ParentName = g.ParentName \n\t\t\tGROUP BY p2.ChildName\n\t\t) as subquery\n\t)\;\n
33;SELECT AVG(MIN(p.age - enkel.age)) AS DURCHSCHNITTSALTER\r\nFROM human p, human enkel, parent ist_kind, parent ist_enkel\r\nWHERE (p.name = ist_kind.ParentName)\r\nAND (ist_kind.ChildName = ist_enkel.ParentName)\r\nAND (ist_enkel.ChildName = enkel.name)\r\nAND (p.gender = 'm') GROUP BY p.name;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 12 \n;SELECT AVG(min) AS DURCHSCHNITTSALTER\nFROM\n\t(\n\t\tSELECT MIN(p.age - enkel.age)\n\t\tFROM human p, human enkel, parent ist_kind, parent ist_enkel\n\t\tWHERE (p.name = ist_kind.ParentName)\n\t\tAND (ist_kind.ChildName = ist_enkel.ParentName)\n\t\tAND (ist_enkel.ChildName = enkel.name)\n\t\tAND (p.gender = 'm') GROUP BY p.name\n\t) as subquery\n
55;SELECT w.bezirk, SUM(w.gross) FLAECHE\r\nFROM   wohnung w, mietet m\r\nWHERE  w.wohnnr=m.wohnnr AND m.bis=TO_DATE('31-12-2099','DD-MM-YYYY') GROUP BY w.bezirk\r\nHAVING SUM(w.gross)> (SELECT AVG(SUM(w1.gross))\r\n                      FROM   wohnung w1, mietet m1\r\n                      WHERE  w1.wohnnr=m1.wohnnr AND m1.bis=TO_DATE('31-12-2099','DD-MM-YYYY')                      GROUP BY w1.bezirk)\r\n;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 190 \n;SELECT w.bezirk, SUM(w.gross) FLAECHE\nFROM   wohnung w, mietet m\nWHERE  w.wohnnr=m.wohnnr AND m.bis=TO_DATE('31-12-2099','DD-MM-YYYY') GROUP BY w.bezirk\nHAVING SUM(w.gross)> \n\t(\n\t\tSELECT AVG(sum)\n\t\tFROM\n\t\t(\n\t\t\t SELECT SUM(w1.gross)\n             FROM   wohnung w1, mietet m1\n            WHERE  w1.wohnnr=m1.wohnnr AND m1.bis=TO_DATE('31-12-2099','DD-MM-YYYY')                      \n\t\t\tGROUP BY w1.bezirk\n\t\t) as subquery\t\t\t\n)
68;select r.recordid, r.title, count(*) Tracks \r\nfrom   record r, track t \r\nwhere  r.recordid=t.recordid \r\ngroup by r.recordid, r.title \r\nhaving count(*) = (select max(count(*)) \r\n                    from   record r1, track t1 \r\n                    where  r1.recordid=t1.recordid \r\n                    group by r1.recordid) order by r.title\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 166 \n;select r.recordid, r.title, count(*) Tracks \nfrom   record r, track t \nwhere  r.recordid=t.recordid \ngroup by r.recordid, r.title \nhaving count(*) = \n\t(\n\t\tselect max(count)\n\t\tfrom\n\t\t(\n\t\t\tselect count(*) \n            from   record r1, track t1 \n            where  r1.recordid=t1.recordid \n            group by r1.recordid\n\t\t\t\n\t\t) as subquery\n\t)\norder by r.title\n
104;SELECT AVG(COUNT(*)) AS AVG_Anzahl FROM   konto k GROUP BY k.inhname, k.gebdat;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 12 \n;SELECT AVG(count)AS AVG_Anzahl\nFROM\n(\n\tSELECT COUNT(*)  FROM   konto k GROUP BY k.inhname, k.gebdat\n) as subquery\n
108;select i1.name, i1.gebdat, i1.adresse, count(*) anzahl, sum(betrag) sum_betrag\r\nfrom   inhaber i1, konto k1, buchung b1\r\nwhere  i1.name = k1.inhname and i1.gebdat = k1.gebdat\r\nand    k1.kontonr = b1.aufkonto\r\ngroup by i1.name, i1.gebdat, i1.adresse\r\nhaving count(*) >\r\n       (select avg(count(*))\r\n        from   konto k2, buchung b2\r\n        where  k2.kontonr = b2.aufkonto\r\n        group by k2.inhname, k2.gebdat);org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 289 \n;select i1.name, i1.gebdat, i1.adresse, count(*) anzahl, sum(betrag) sum_betrag\nfrom   inhaber i1, konto k1, buchung b1\nwhere  i1.name = k1.inhname and i1.gebdat = k1.gebdat\nand    k1.kontonr = b1.aufkonto\ngroup by i1.name, i1.gebdat, i1.adresse\nhaving count(*) >\n       (select avg(count)\n\t\tfrom\n\t\t\t(\n\t\t\tSelect count(*)\n\t\t\tfrom   konto k2, buchung b2\n\t\t\twhere  k2.kontonr = b2.aufkonto\n\t\t\tgroup by k2.inhname, k2.gebdat\n\t\t\t) as subquery\n\t\t)\n
71;select f.kurzbez, f.bezeichnung, count(*) Anzahl\r\nfrom fakultaet f, studienrichtung s, koje k\r\nwhere s.gehoert_zu = f.kurzbez AND\r\n      k.gemietet_von = s.kennzahl\r\ngroup by f.kurzbez, f.bezeichnung\r\nhaving count (standnr) = (\r\n select MAX (count(*))\r\n from studienrichtung s2, koje k2\r\n where k2.gemietet_von = s2.kennzahl\r\n group by s2.gehoert_zu)\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 243 \n;select f.kurzbez, f.bezeichnung, count(*) Anzahl\nfrom fakultaet f, studienrichtung s, koje k\nwhere s.gehoert_zu = f.kurzbez AND\n      k.gemietet_von = s.kennzahl\ngroup by f.kurzbez, f.bezeichnung\nhaving count (standnr) = \n(\n \tselect MAX(count)\n\tfrom\n\t(\n\t\tselect count(*)\n \t\tfrom studienrichtung s2, koje k2\n \t\twhere k2.gemietet_von = s2.kennzahl\n\t\tgroup by s2.gehoert_zu\n\t) as subquery\n)\;\n
13089;\t\r\nDROP TABLE ETUTOR_JESS.JessExercise\;\r\n\r\nCREATE ETUTOR_JESS.TABLE JessExercise (\r\n\tid\tNUMBER,\r\n\tprivate_facts VARCHAR(4000),\r\n\tpublic_facts VARCHAR(4000),\r\n\treference_solution VARCHAR(4000),\r\n\ttransitivity NUMBER,\r\n\trecursion NUMBER,\r\n\tnegation NUMBER,\r\n\tsearchtree NUMBER,\r\n\texampletype NUMBER,\r\n\tmaximumpoints NUMBER,\r\n\tPRIMARY KEY(id)\r\n\t)\;\r\n;org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »CREATE«\n  Position: 43 \n;\N
2;SELECT r1.recordId, r1.artistName, r1.title\r\nFROM   record r1, track t1\r\nWHERE  r1.type='Album' AND r1.recordId=t1.recordId\r\nGROUP BY r1.recordId, r1.artistName, r1.title\r\nHAVING SUM(length) <\r\n  (SELECT AVG(SUM(t2.length))\r\n  FROM record r2, track t2\r\n  WHERE r2.type='Album' AND r2.recordId=t2.recordId\r\n  GROUP BY r2.recordId)\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 209 \n;SELECT r1.recordId, r1.artistName, r1.title\nFROM   record r1, track t1\nWHERE  r1.type='Album' AND r1.recordId=t1.recordId\nGROUP BY r1.recordId, r1.artistName, r1.title\nHAVING SUM(length) <\n  (SELECT \n   \t\tAVG(sum)\n\tFROM\n\t\t(\n\t\tSELECT\n\t\t\tSUM(t2.length) \n\t\tFROM \n\t\t\trecord r2, track t2\n\t\tWHERE \n\t\t\tr2.type='Album' AND r2.recordId=t2.recordId\n\t\tGROUP BY \n\t\t\tr2.recordId \n\t\t) as subquery\n  )\n\;
153;SELECT   AVG(count(*)) AS avgsupervised\r\nFROM     staff s1, staff s2\r\nWHERE    s1.snum = s2.supervisor \r\nGROUP BY s1.snum\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 14 \n;SELECT   AVG(count) AS avgsupervised\nFROM\n(\n\tselect count(*)\n\tFROM     staff s1, staff s2\n\tWHERE    s1.snum = s2.supervisor \n\tGROUP BY s1.snum\n) as subquery\n
10009;select pu.prodno, t.m month, SUM(pu.qty*pu.price) value\r\nfrom   purchase pu, time t\r\nwhere  pu.dayno=t.dayno\r\ngroup by pu.prodno, t.m;org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »month«\n  Position: 23 \n;select pu.prodno, t.m as month, SUM(pu.qty*pu.price) as value\nfrom   purchase pu, time t\nwhere  pu.dayno=t.dayno\ngroup by pu.prodno, t.m\n
10010;select pu.prodno, t.m month, SUM(pu.qty*pu.price) value\r\nfrom   purchase pu, time t\r\nwhere  pu.dayno=t.dayno\r\ngroup by grouping sets ((pu.prodno, t.m), (pu.prodno));org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »month«\n  Position: 23 \n;select pu.prodno, t.m as month, SUM(pu.qty*pu.price) as value\nfrom   purchase pu, time t\nwhere  pu.dayno=t.dayno\ngroup by grouping sets ((pu.prodno, t.m), (pu.prodno))\n
10012;select pu.prodno, t.m month, SUM(pu.qty*pu.price) value,\r\nSUM(SUM(pu.qty*pu.price)) OVER \r\n(PARTITION BY pu.prodno ORDER BY t.m ROWS UNBOUNDED PRECEDING) cumvalue\r\nfrom   purchase pu, time t\r\nwhere  pu.dayno=t.dayno\r\ngroup by pu.prodno, t.m\;\r\n;org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »month«\n  Position: 23 \n;select pu.prodno, t.m as month, SUM(pu.qty*pu.price) as value,\nSUM(SUM(pu.qty*pu.price)) OVER \n(PARTITION BY pu.prodno ORDER BY t.m ROWS UNBOUNDED PRECEDING) cumvalue\nfrom   purchase pu, time t\nwhere  pu.dayno=t.dayno\ngroup by pu.prodno, t.m\;\n
13783;select e.entlngnr, e.von, be.name, bu.titel\r\nfrom entlehng e, benutzer be, buch bu\r\nwhere (e.buch = bu.buchnr) and (e.benutzer = be.bennr) and\r\n      (e.bis = '01-01-2999') and ((e.von + 100) < SYSDATE)\r\norder by be.name\;;org.postgresql.util.PSQLException: FEHLER: Spalte »sysdate« existiert nicht\n  Position: 195 \n;select e.entlngnr, e.von, be.name, bu.titel\nfrom entlehng e, benutzer be, buch bu\nwhere (e.buch = bu.buchnr) and (e.benutzer = be.bennr) and\n      (e.bis = '01-01-2999') and ((e.von + 100) < current_date)\norder by be.name\;\n
13877;select distinct k.gebiet\r\nfrom kunde k, auftragskopf ak, auftragszeile az\r\nwhere k.nr = ak.kunde AND\r\n      ak.nr = az.nr\r\ngroup by k.gebiet\r\nhaving sum(az.vkpreis * az.menge) = (\r\n  select max (sum(az2.vkpreis * az2.menge))\r\n  from kunde k2, auftragskopf ak2, auftragszeile az2\r\n  where k2.nr = ak2.kunde AND\r\n        ak2.nr = az2.nr\r\ngroup by k2.gebiet)\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 196 \n;select distinct k.gebiet\nfrom kunde k, auftragskopf ak, auftragszeile az\nwhere k.nr = ak.kunde AND\n      ak.nr = az.nr\ngroup by k.gebiet\nhaving sum(az.vkpreis * az.menge) = \n\t(\n  \tselect max(sum)\n\tfrom\n\t\t(\n\t\t\tselect sum(az2.vkpreis * az2.menge)\n\t\t\t  from kunde k2, auftragskopf ak2, auftragszeile az2\n\t\t\t  where k2.nr = ak2.kunde AND\n        \t\tak2.nr = az2.nr\n\t\t\tgroup by k2.gebiet\n\t\t)as subquery\n\t)\;\n
13882;(select k.nr, k.name\r\n from kunde k, auftragskopf ak, auftragszeile az\r\n where k.nr = ak.kunde and\r\n       ak.nr = az.nr and\r\n       az.menge > 0\r\n)\r\nMINUS\r\n(select k2.nr, k2.name\r\n from kunde k2, auftragskopf ak2\r\n where k2.nr = ak2.kunde and ak2.vertreter = 'GP')\;;org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »MINUS«\n  Position: 151 \n;(select k.nr, k.name\n from kunde k, auftragskopf ak, auftragszeile az\n where k.nr = ak.kunde and\n       ak.nr = az.nr and\n       az.menge > 0\n)\nEXCEPT\n(select k2.nr, k2.name\n from kunde k2, auftragskopf ak2\n where k2.nr = ak2.kunde and ak2.vertreter = 'GP')\;\n
13883;select count(*) from cat;org.postgresql.util.PSQLException: FEHLER: Relation »cat« existiert nicht\n  Position: 22 \n;Keine Ahnung wo die tabelle cat sein soll\n
13884;select count(*) from cat;org.postgresql.util.PSQLException: FEHLER: Relation »cat« existiert nicht\n  Position: 22 \n;Keine Ahnung wo die tabelle cat sein soll\n
13885;select * from cat;org.postgresql.util.PSQLException: FEHLER: Relation »cat« existiert nicht\n  Position: 15 \n;Keine Ahnung wo die tabelle cat sein soll\n
13887;select * from cat;org.postgresql.util.PSQLException: FEHLER: Relation »cat« existiert nicht\n  Position: 15 \n;Keine Ahnung wo die tabelle cat sein soll\n
10011;select pu.prodno, t.y year, t.m month, SUM(pu.qty*pu.price) value\r\nfrom   purchase pu, time t\r\nwhere  pu.dayno=t.dayno\r\ngroup by rollup (pu.prodno, t.y, t.m)\r\norder by pu.prodno, t.y, t.m;org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »year«\n  Position: 23 \n;select pu.prodno, t.y as year, t.m as month, SUM(pu.qty*pu.price) as value\nfrom   purchase pu, time t\nwhere  pu.dayno=t.dayno\ngroup by rollup (pu.prodno, t.y, t.m)\norder by pu.prodno, t.y, t.m\n
23;(SELECT k.kundenr, k.name\r\nFROM   kunde k, rechnung r, rechnungpos rp, produkt p\r\nWHERE  k.kundenr=r.kundenr\r\nAND    r.rechnungnr=rp.rechnungnr\r\nAND    r.datum=rp.datum\r\nAND    rp.ean=p.ean\r\nAND    p.kategorie='Audio')\r\nINTERSECT\r\n(SELECT k.kundenr, k.name\r\nFROM   kunde k, rechnung r, rechnungpos rp, produkt p\r\nWHERE  k.kundenr=r.kundenr\r\nAND    r.rechnungnr=rp.rechnungnr\r\nAND    r.datum=rp.datum\r\nAND    rp.ean=p.ean\r\nAND    p.kategorie='Sonstiges')\r\nMINUS\r\n(SELECT k.kundenr, k.name\r\nFROM   kunde k, rechnung r, rechnungpos rp, produkt p\r\nWHERE  k.kundenr=r.kundenr\r\nAND    r.rechnungnr=rp.rechnungnr\r\nAND    r.datum=rp.datum\r\nAND    rp.ean=p.ean\r\nAND    p.kategorie='Pflege')\r\n;org.postgresql.util.PSQLException: FEHLER: Syntaxfehler bei »MINUS«\n  Position: 456 \n;(SELECT k.kundenr, k.name\nFROM   kunde k, rechnung r, rechnungpos rp, produkt p\nWHERE  k.kundenr=r.kundenr\nAND    r.rechnungnr=rp.rechnungnr\nAND    r.datum=rp.datum\nAND    rp.ean=p.ean\nAND    p.kategorie='Audio')\nINTERSECT\n(SELECT k.kundenr, k.name\nFROM   kunde k, rechnung r, rechnungpos rp, produkt p\nWHERE  k.kundenr=r.kundenr\nAND    r.rechnungnr=rp.rechnungnr\nAND    r.datum=rp.datum\nAND    rp.ean=p.ean\nAND    p.kategorie='Sonstiges')\nEXCEPT\n(SELECT k.kundenr, k.name\nFROM   kunde k, rechnung r, rechnungpos rp, produkt p\nWHERE  k.kundenr=r.kundenr\nAND    r.rechnungnr=rp.rechnungnr\nAND    r.datum=rp.datum\nAND    rp.ean=p.ean\nAND    p.kategorie='Pflege')
39;select w.wohnnr, w.gross, count(*) Anzahlmietverh, avg(m.preis/w.gross) D_Miete, max(m.preis/w.gross) Hoechstmiete\r\nfrom   wohnung w, mietet m\r\nwhere  w.wohnnr=m.wohnnr\r\ngroup by w.wohnnr, w.gross\r\nhaving max(m.preis/w.gross) > \r\n          (select avg(max(m1.preis/w1.gross))\r\n           from   wohnung w1, mietet m1\r\n           where  w1.wohnnr=m1.wohnnr\r\n           group by w1.wohnnr)\r\norder by w.wohnnr;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 253 \n; select w.wohnnr, w.gross, count(*) Anzahlmietverh, avg(m.preis/w.gross) D_Miete, max(m.preis/w.gross) Hoechstmiete\nfrom   wohnung w, mietet m\nwhere  w.wohnnr=m.wohnnr\ngroup by w.wohnnr, w.gross\nhaving max(m.preis/w.gross) > \n          (\n\t\t\t  select avg(max)\n\t\t\t  from\n\t\t\t  (\n\t\t\t  \t \tselect (max(m1.preis/w1.gross))\n\t\t\t\t   from   wohnung w1, mietet m1\n\t\t\t\t   where  w1.wohnnr=m1.wohnnr\n\t\t\t\t   group by w1.wohnnr\n\t\t\t  ) as subquery\n\t\t   )\norder by w.wohnnr
59;SELECT bezirk, SUM(erloes) as MIETEINNAHMEN FROM \r\n((SELECT w.bezirk, SUM(ROUND(MONTHS_BETWEEN(m.bis, m.von))*m.preis) erloes\r\nFROM   wohnung w, mietet m\r\nWHERE  w.wohnnr=m.wohnnr\r\nAND    m.bis <> TO_DATE('31-12-2099','DD-MM-YYYY')\r\nGROUP BY w.bezirk)\r\nUNION\r\n(SELECT w.bezirk, SUM(ROUND(MONTHS_BETWEEN(SYSDATE, m.von))*m.preis) erloes\r\nFROM   wohnung w, mietet m\r\nWHERE  w.wohnnr=m.wohnnr\r\nAND    m.bis = TO_DATE('31-12-2099','DD-MM-YYYY')\r\nGROUP BY w.bezirk))\r\nGROUP BY bezirk\r\nHAVING SUM(erloes)=(SELECT MAX(SUM(erloes)) \r\n                    FROM ((SELECT w.bezirk, SUM(ROUND(MONTHS_BETWEEN(m.bis, m.von))*m.preis) erloes\r\n                           FROM   wohnung w, mietet m\r\n                           WHERE  w.wohnnr=m.wohnnr\r\n                           AND    m.bis <> TO_DATE('31-12-2099','DD-MM-YYYY')\r\n                           GROUP BY w.bezirk)\r\n                          UNION\r\n                          (SELECT w.bezirk, SUM(ROUND(MONTHS_BETWEEN(SYSDATE, m.von))*m.preis) erloes\r\n                           FROM   wohnung w, mietet m\r\n                           WHERE  w.wohnnr=m.wohnnr\r\n                           AND    m.bis = TO_DATE('31-12-2099','DD-MM-YYYY')\r\n                           GROUP BY w.bezirk))\r\n                          GROUP BY bezirk)\r\n;org.postgresql.util.PSQLException: FEHLER: Unteranfrage in FROM muss Aliasnamen erhalten\n  Hinweis: Zum Beispiel FROM (SELECT ...) [AS] xyz.\n  Position: 52 \n;SELECT bezirk, SUM(erloes) as MIETEINNAHMEN \nFROM \n\t(\n\t\t(\n\t\t\tSELECT w.bezirk, SUM(ROUND(extract(year from (age(m.bis, m.von)))*12 + extract(month from (age(m.bis, m.von))))*m.preis) erloes\n\t\t\tFROM   wohnung w, mietet m\n\t\t\tWHERE  w.wohnnr=m.wohnnr\n\t\t\tAND    m.bis <> TO_DATE('31-12-2099','DD-MM-YYYY')\n\t\t\tGROUP BY w.bezirk\n\t\t) \n\t\tUNION\n\t\t(\n\t\t\tSELECT w.bezirk, SUM(ROUND( extract(year from (age(current_date, m.von)))*12+ extract(month from (age(current_date, m.von))))*m.preis) erloes\n\t\t\tFROM   wohnung w, mietet m\n\t\t\tWHERE  w.wohnnr=m.wohnnr\n\t\t\tAND    m.bis = TO_DATE('31-12-2099','DD-MM-YYYY')\n\t\t\tGROUP BY w.bezirk\n\t\t)\n\t)as subquery\nGROUP BY bezirk\nHAVING SUM(erloes)=\n\t\t(\n\t\t\tSELECT MAX(sum)\n\t\t\tFROM \n\t\t\t(\n\t\t\tSELECT SUM(erloes) \n            FROM \n\t\t\t\t(\n\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT w.bezirk, SUM(ROUND( extract(year from (age(m.bis, m.von)))*12+ extract(month from (age(m.bis, m.von))))*m.preis) erloes\n                           FROM   wohnung w, mietet m\n                           WHERE  w.wohnnr=m.wohnnr\n                           AND    m.bis <> TO_DATE('31-12-2099','DD-MM-YYYY')\n                           GROUP BY w.bezirk\n\t\t\t\t\t)\n                          UNION\n                          (\n\t\t\t\t\t\t\t  SELECT w.bezirk, SUM(ROUND(extract(year from (age(current_date, m.von)))*12+extract(month from (age(current_date, m.von))))*m.preis) erloes\n\t\t\t\t\t\t\t   FROM   wohnung w, mietet m\n\t\t\t\t\t\t\t   WHERE  w.wohnnr=m.wohnnr\n\t\t\t\t\t\t\t  AND    m.bis = TO_DATE('31-12-2099','DD-MM-YYYY')\n\t\t\t\t\t\t\t   GROUP BY w.bezirk\n\t\t\t\t\t\t\t)\n\t\t\t\t\t) as subquery\n\t\t\t\tGROUP BY bezirk\n\t\t\t\t) as subquery2\n\t\t) \n
26;SELECT f.filnr, f.plz, SUM(p.ekpreis * s.bestand) as Lagerwert\r\nFROM   filiale f, produkt p, sortiment s\r\nWHERE  f.filnr = s.filnr\r\nAND    p.ean = s.ean\r\nAND    p.kategorie = 'Ersatz'\r\nGROUP BY f.filnr, f.plz\r\nHAVING SUM(p.ekpreis * s.bestand) > \r\n                 (SELECT AVG(SUM(p1.ekpreis * s1.bestand))\r\n                  FROM   produkt p1, sortiment s1\r\n                  WHERE  p1.ean = s1.ean\r\n                  AND    p1.kategorie = 'Ersatz'\r\n                  GROUP BY s1.filnr);org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 278 \n;SELECT f.filnr, f.plz, SUM(p.ekpreis * s.bestand) as Lagerwert\nFROM   filiale f, produkt p, sortiment s\nWHERE  f.filnr = s.filnr\nAND    p.ean = s.ean\nAND    p.kategorie = 'Ersatz'\nGROUP BY f.filnr, f.plz\nHAVING SUM(p.ekpreis * s.bestand) > \n                (\n\t\t\t\tSELECT \n\t\t\t\t  \tAVG(sum)\n\t\t\t\tFROM\n\t\t\t\t  \t(\n\t\t\t\t\tSELECT\n\t\t\t\t\t\tSUM(p1.ekpreis * s1.bestand)\n                  \tFROM   \n\t\t\t\t  \t\tprodukt p1, sortiment s1\n                 \tWHERE  \n\t\t\t\t  \t\tp1.ean = s1.ean\n                  \t\tAND    p1.kategorie = 'Ersatz'\n                  \tGROUP BY s1.filnr\n\t\t\t\t \t) as subquery\n\t\t\t\t)\;\n\t\t\t\t \n
13171;select buchngnr, betrag\r\nfrom buchung\r\nwhere vonkonto in\r\n  (select kontonr\r\n   from konto\r\n   where ADD_MONTHS(sysdate, -360)<gebdat)\r\nor aufkonto in \r\n  (select kontonr\r\n   from konto\r\n   where ADD_MONTHS(sysdate, -360)<gebdat)\r\norder by betrag desc\;\r\n;org.postgresql.util.PSQLException: FEHLER: Spalte »sysdate« existiert nicht\n  Position: 113 \n;select buchngnr, betrag\nfrom buchung\nwhere vonkonto in\n  (select kontonr\n   from konto\n   where (current_date - interval '360 months')<gebdat)\nor aufkonto in \n  (select kontonr\n   from konto\n   where (current_date - interval '360 months')<gebdat)\norder by betrag desc\;\n
13868;Select rp.rechnungnr, rp.datum, sum((rp.einzelpreis-p.ekpreis)*rp.menge) RG\r\nfrom rechnungpos rp, produkt p\r\nwhere p.ean=rp.ean\r\ngroup by rp.rechnungnr, rp.datum\r\nhaving sum((rp.einzelpreis-p.ekpreis)*rp.menge)\r\n       > (select avg(sum((rp2.einzelpreis-p2.ekpreis)*rp2.menge))\r\n          from rechnungpos rp2, produkt p2\r\n          where rp2.ean=p2.ean\r\n          group by rp2.rechnungnr, rp2.datum)\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 234 \n;Select rp.rechnungnr, rp.datum, sum((rp.einzelpreis-p.ekpreis)*rp.menge) RG\nfrom rechnungpos rp, produkt p\nwhere p.ean=rp.ean\ngroup by rp.rechnungnr, rp.datum\nhaving sum((rp.einzelpreis-p.ekpreis)*rp.menge)\n       > (select avg(sum)\n\t\t  from\n\t\t  \t(\n\t\t  \t  select sum((rp2.einzelpreis-p2.ekpreis)*rp2.menge)\n\t\t\t  from rechnungpos rp2, produkt p2\n\t\t\t  where rp2.ean=p2.ean\n\t\t\t  group by rp2.rechnungnr, rp2.datum\n\t\t  \t)as subquery\n\t\t  )\n
13870;select f.filnr, f.plz, sum(rp.menge*rp.einzelpreis) Umsatz\r\nfrom filiale f, rechnung r, rechnungpos rp\r\nwhere f.filnr=r.filnr\r\nand r.rechnungnr=rp.rechnungnr and r.datum = rp.datum\r\ngroup by f.filnr, f.plz\r\nhaving sum(rp.menge*rp.einzelpreis) >\r\n  (select avg(sum(rp2.menge*rp2.einzelpreis))\r\n   from filiale f2, rechnung r2, rechnungpos rp2\r\n   where f2.filnr=r2.filnr and r2.rechnungnr=rp2.rechnungnr and r2.datum=rp2.datum\r\n   group by f2.filnr)\r\norder by umsatz desc\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 261 \n;select f.filnr, f.plz, sum(rp.menge*rp.einzelpreis) Umsatz\nfrom filiale f, rechnung r, rechnungpos rp\nwhere f.filnr=r.filnr\nand r.rechnungnr=rp.rechnungnr and r.datum = rp.datum\ngroup by f.filnr, f.plz\nhaving sum(rp.menge*rp.einzelpreis) >\n  (select avg(sum)\n   from\n\t   (\n\t\t   select sum(rp2.menge*rp2.einzelpreis)\n\t\t   from filiale f2, rechnung r2, rechnungpos rp2\n\t\t   where f2.filnr=r2.filnr and r2.rechnungnr=rp2.rechnungnr and r2.datum=rp2.datum\n\t\t   group by f2.filnr\n\t   )as subquery\n\t)  \norder by umsatz desc\;\n
13175;select i.name, i.gebdat, i.adresse, count(*)anzahl\r\nfrom inhaber i, konto k\r\nwhere i.name=k.inhname and i.gebdat=k.gebdat\r\ngroup by i.name, i.gebdat, i.adresse\r\nhaving count(*) >\r\n  (select avg(count(*))\r\n   from konto\r\n   group by inhname, gebdat)\;;org.postgresql.util.PSQLException: FEHLER: Aufrufe von Aggregatfunktionen können nicht geschachtelt werden\n  Position: 195 \n;select i.name, i.gebdat, i.adresse, count(*)anzahl\nfrom inhaber i, konto k\nwhere i.name=k.inhname and i.gebdat=k.gebdat\ngroup by i.name, i.gebdat, i.adresse\nhaving count(*) >\n  (select avg(count)\n   from\n   (select count(*)\n   from konto\n   group by inhname, gebdat\n   )as subquery\n   )\;\n
